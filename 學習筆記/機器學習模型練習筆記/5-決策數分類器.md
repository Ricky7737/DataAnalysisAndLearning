# DecisionTreeClassifier(決策樹分類器)



## Sklearn DecisionTreeClassifier 程式實作
* 程式實作程式以 Sklearn 提供的 Iris 下去練習
### 1.載入套件
```
# 載入資料 與 pandas 套件
from sklearn.datasets import load_iris
import pandas as pd
# 繪製圖片工具
import matplotlib.pyplot as plt
import seaborn as sns
# 切割資料工具
from sklearn.model_selection import train_test_split
# 載入決策數分類器
from sklearn.tree import DecisionTreeClassifier
# 決策樹視覺化
from sklearn.tree import export_graphviz
import graphviz
```

### 2.載入資料 
```
# 從 Sklearn 載入鳶尾花資料集
iris = load_iris()

# 將 iris 資料轉換成 dataframe
#  columns: 將直行名稱設定為feature_names欄位，方便觀察
iris_df = pd.DataFrame(iris['data'], columns=iris['feature_names'])

# 新增 taget 欄位
iris_df['target'] = iris['target']
```
* 資料如下
![image](https://github.com/Ricky7737/DataAnalysisAndLearning/assets/58324475/d692350a-fa76-4dc9-9ba3-801de49df4a4)

#### 欄位資料特徵
  * Sepal length: 花萼長度 (cm)
  * Sepal width: 花萼寬度 (cm)
  * Petal length: 花瓣長度 (cm)
  * Petal width: 花瓣寬度 (cm)


### 3.繪製熱像關係矩陣圖
```
# 繪製關係矩陣熱像圖
correlation_matrix = iris_df.corr()
plt.figure(figsize=(8, 6))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm", fmt=".2f")
plt.title("iris correlation matrix")
plt.show()
```
* 圖片如下
  ![image](https://github.com/Ricky7737/DataAnalysisAndLearning/assets/58324475/cdf89b46-be37-4dac-973f-5afbfd6cb790)

#### 由上面關係矩陣圖來看
  * ``` 0 代表 Setosa 山鳶尾```、```1 代表 versicolor 變色鳶尾``` 、 ```2 代表 virginica 維吉尼亞鳶尾```
  * 1.```Sepal width: 花萼寬度 (cm)``` 與 ```taget```呈現負相關系數，也就是花萼寬度越大越有可能是 ```Setosa 山鳶尾```
  * 2.其他特徵來說，都是與 ```target``` 呈現正相關

### 4.切割資料
```
# 切割資料
# 先刪除目標
X = iris_df.drop(['target'], axis=1)
y = iris_df['target']

# test_size=0.2 測試集佔 2 成
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
```
### 5.建立 DecisionTreeClassifier 模型
```
# 使用決策樹
# max_depth 樹最多有三層
clf = DecisionTreeClassifier(max_depth=3)

# 擬合資料
clf.fit(X_train, y_train)
```

### 6.將決策樹視覺化
```
# 將決策數視覺化
# 繪製決策樹圖
# 獲取特徵名稱的列表
# Define class names as a list
g = export_graphviz(clf, out_file=None, feature_names=iris["feature_names"],
                    class_names=iris["target_names"],
                    filled=True, special_characters=True)                

# graph是把g畫成圖
graph = graphviz.Source(g)
graph
```
* 決策樹視覺化圖片
* ![image](https://github.com/Ricky7737/DataAnalysisAndLearning/assets/58324475/a9ae4e88-3f7d-4922-a241-257657f867e5)



* code link : https://github.com/Ricky7737/DataAnalysisAndLearning/blob/main/%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%A8%A1%E5%9E%8B%E7%B7%B4%E7%BF%92%E7%AD%86%E8%A8%98/%E7%B7%B4%E7%BF%92%E7%A8%8B%E5%BC%8F%E7%A2%BC/5-IrisUseDecsionTree.ipynb



#### 參考資料 :
* [1] 決策數分類器參數 : https://scikit-learn.org/0.15/modules/generated/sklearn.tree.DecisionTreeClassifier.html
